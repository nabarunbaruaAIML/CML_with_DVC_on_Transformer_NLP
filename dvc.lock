schema: '2.0'
stages:
  stage_01_load_save:
    cmd: python src/stage_01_load_save.py --config=configs/config.yaml --params=params.yaml
    deps:
    - path: configs/config.yaml
      md5: 3c4a743c067bc745e14c4f83e90d81a5
      size: 971
    - path: src/stage_01_load_save.py
      md5: e8587debf4e7f7020b93c1e4c5702c56
      size: 3535
    - path: src/utils/all_utils.py
      md5: 1f3b8106288c567dcbd59a31558ff8fe
      size: 15595
    params:
      params.yaml:
        TrainingArgument.run_name: albert-base-v2_Run_DVC_5
    outs:
    - path: artifacts/Data/atis_intents.csv
      md5: 9f19d740a9876212b24bc0dd89b508a1
      size: 391936
    - path: artifacts/Data/atis_intents_test.csv
      md5: 512f03dfe6642cfcddb63d59ea93df20
      size: 58152
    - path: artifacts/Data/atis_intents_train.csv
      md5: d7358f4c0510c4e3263adbecf6227cf6
      size: 381136
  stage_02_prepare_data:
    cmd: python src/stage_02_prepare_dataset.py --config=configs/config.yaml --params=params.yaml
    deps:
    - path: artifacts/Data/atis_intents.csv
      md5: 9f19d740a9876212b24bc0dd89b508a1
      size: 391936
    - path: configs/config.yaml
      md5: 3c4a743c067bc745e14c4f83e90d81a5
      size: 971
    - path: src/stage_02_prepare_dataset.py
      md5: 70fbd2c3369f88c09e36d238ee3732ab
      size: 4750
    - path: src/utils/all_utils.py
      md5: 1f3b8106288c567dcbd59a31558ff8fe
      size: 15595
    params:
      params.yaml:
        Dataset.test_size: 0.1
        TrainingArgument.run_name: albert-base-v2_Run_DVC_5
        model.base_model: albert-base-v2
        model.max_length: 128
        model.padding: max_length
        model.truncation: true
        model.use_fast: true
    outs:
    - path: artifacts/Data/Dataset
      md5: 8b0949ef8001e7abc7efbf28c77547fa.dir
      size: 3931995
      nfiles: 7
    - path: artifacts/Data/id2label.json
      md5: 4eb8692137a88c2bfb00f3d41e3f59b9
      size: 707
    - path: artifacts/Data/label2id.json
      md5: c5791b32b443d9521edf3ac383748985
      size: 663
    - path: artifacts/Data/label_num.json
      md5: 720ce1dfb128c5878d779d4ad13c3073
      size: 31
    - path: artifacts/base_model
      md5: 9ac923b40c55fdf3a26ce780c2d0cc6c.dir
      size: 2074033
      nfiles: 6
  stage_03_dataset_split:
    cmd: python src/stage_03_train_test_split_dataset.py --config=configs/config.yaml
      --params=params.yaml
    deps:
    - path: artifacts/Data/Data.csv
      md5: c63b12fede80cb3caabe3e53703f1938
      size: 3986929
    - path: configs/config.yaml
      md5: 688a3e75e8fa814c595f92a3439c778a
      size: 816
    - path: src/stage_03_train_test_split_dataset.py
      md5: f1755275c4c9c1511a491a27148d5250
      size: 2283
    - path: src/utils/all_utils.py
      md5: a62828a899b7c1f640022613cc360b66
      size: 3931
    params:
      params.yaml:
        Dataset.test_size: 0.1
    outs:
    - path: artifacts/Data/Dataset
      md5: 9878c49cd151fe21328d22518eb2bc18.dir
      size: 4023371
      nfiles: 7
  stage_03_Train:
    cmd: python src/stage_03_train.py --config=configs/config.yaml --params=params.yaml
    deps:
    - path: artifacts/Data/Dataset
      md5: 8b0949ef8001e7abc7efbf28c77547fa.dir
      size: 3931995
      nfiles: 7
    - path: artifacts/Data/label_num.json
      md5: 720ce1dfb128c5878d779d4ad13c3073
      size: 31
    - path: configs/config.yaml
      md5: 3c4a743c067bc745e14c4f83e90d81a5
      size: 971
    - path: src/stage_03_train.py
      md5: bdff1b27cb4bc15974f4d52308d625d6
      size: 8466
    - path: src/utils/all_utils.py
      md5: 1f3b8106288c567dcbd59a31558ff8fe
      size: 15595
    params:
      params.yaml:
        TrainingArgument.Cuda: false
        TrainingArgument.Early_Stopping_patience: 2
        TrainingArgument.Evaluation_Strategy: epoch
        TrainingArgument.Learning_Rate: 2e-05
        TrainingArgument.Load_Best_Model_At_End: true
        TrainingArgument.Num_Train_Epochs: 3
        TrainingArgument.Output_Dir: artifacts/Sentence-Classif
        TrainingArgument.Per_Device_Eval_Batch_Size: 16
        TrainingArgument.Per_Device_Train_Batch_Size: 16
        TrainingArgument.Save_Strategy: epoch
        TrainingArgument.Save_Total_Limit: 5
        TrainingArgument.WANDB_PROJECT: Text_Classification
        TrainingArgument.Warmup_Ratio: 0.1
        TrainingArgument.Weight_Decay: 0.01
        TrainingArgument.metric_name: matthews_correlation
        TrainingArgument.report_to: wandb
        TrainingArgument.run_name: albert-base-v2_Run_DVC_5
        model.base_model: albert-base-v2
        model.max_length: 128
        model.padding: max_length
        model.truncation: true
        model.use_fast: true
    outs:
    - path: artifacts/Best_Model
      md5: 835b1fe53c17ff3de15ed1300585ee0b.dir
      size: 48135439
      nfiles: 7
    - path: artifacts/Sentence-Classif
      md5: 442ed2071fceb1680f138e32e0670c70.dir
      size: 425307629
      nfiles: 30
    - path: wandb
      md5: c47a6e45c1d624e5aa2b5392cd3c2057.dir
      size: 516914
      nfiles: 9
  stage_04_Onnx:
    cmd: python src/stage_04_onnx.py --config=configs/config.yaml --params=params.yaml
    deps:
    - path: artifacts/Best_Model
      md5: 835b1fe53c17ff3de15ed1300585ee0b.dir
      size: 48135439
      nfiles: 7
    - path: configs/config.yaml
      md5: 3c4a743c067bc745e14c4f83e90d81a5
      size: 971
    - path: src/stage_04_onnx.py
      md5: 6b366f3c26fb9bfb039eb676f2580cf0
      size: 5955
    - path: src/utils/all_utils.py
      md5: 1f3b8106288c567dcbd59a31558ff8fe
      size: 15595
    params:
      params.yaml:
        Onnx.atol: 0.0001
        Onnx.feature: sequence-classification
        Onnx.opset: 12
        TrainingArgument.run_name: albert-base-v2_Run_DVC_5
        model.base_model: albert-base-v2
        model.use_fast: true
    outs:
    - path: artifacts/Onnx_Output/model.onnx
      md5: dc6595b3fb5b0c8047b3622293c24a8f
      size: 358299451
    - path: artifacts/Onnx_Output/model_Quantized.onnx
      md5: 3b39d2d03ccbb955a6b0a6675f07a983
      size: 11847311
    - path: artifacts/Onnx_Output/model_compressed-opt.onnx
      md5: b5d8a5fd0d4fa6abbe9c6536faa567eb
      size: 46849185
    - path: artifacts/Onnx_Output/model_compressed.onnx
      md5: c8d43c6058ae83de6b51974d3837c349
      size: 46869254
  stage_05_Model_Evalution:
    cmd: python src/stage_05_Model_Evaluation.py --config=configs/config.yaml --params=params.yaml
    deps:
    - path: artifacts/Onnx_Output/model.onnx
      md5: 78720afad419fa50226314ea051b9e4e
      size: 358269459
    - path: artifacts/Onnx_Output/model_Quantized.onnx
      md5: 7f54eb663bccf4b33792ba3aa6937526
      size: 11802321
    - path: artifacts/Onnx_Output/model_compressed-opt.onnx
      md5: a9cf5612b82c517781de97f3f5289780
      size: 46840802
    - path: artifacts/Onnx_Output/model_compressed.onnx
      md5: b6247aef73edee8083c2ce86d20ee62a
      size: 46840802
    - path: configs/config.yaml
      md5: 3c4a743c067bc745e14c4f83e90d81a5
      size: 971
    - path: src/stage_05_Model_Evaluation.py
      md5: 5a3be086d7cef6413c3523df320a0db8
      size: 9752
    - path: src/utils/all_utils.py
      md5: 1f3b8106288c567dcbd59a31558ff8fe
      size: 15595
    params:
      params.yaml:
        TrainingArgument.WANDB_PROJECT: Text_Classification
        TrainingArgument.metric_name: matthews_correlation
        TrainingArgument.run_name: albert-base-v2_Run_DVC_5
        model.max_length: 128
